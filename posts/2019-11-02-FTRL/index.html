

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Online convex optimization &#8212; Thomas Pethick</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font/cm/Serif/cmun-serif.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/font/cm/Sans/cmun-sans.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'posts/2019-11-02-FTRL';</script>
    <link rel="author" title="About these documents" href="../../about/" />
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Hedge and bandits" href="../2020-01-06-hedge-and-bandit/" />
    <link rel="prev" title="Online learning" href="../../online-learning/" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../posts/atom.xml"
  title="Thomas Pethick's blog"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../">
  
  
  
  
  
    <p class="title logo__title">Thomas Pethick</p>
  
</a></div>
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../about/">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../publications/">Publications</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../online-learning/">Online learning</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Online convex optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2020-01-06-hedge-and-bandit/">Hedge and bandits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2020-01-07-gp-mw/">Gaussian processes and Hedge for infinite armed bandits</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../talks/">Talks</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2019-11-03-russell-talk/">Provably beneficial artificial intelligence by Stuart Russell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2019-11-16-caroline-uhler/">From causal inference to autoencoders and gene regulation by Caroline Uhler</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../">Posts</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2020-06-04-acceleration-with-potential-function/">Acceleration convergence using a potential function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2020-06-04-acceleration-perspectives/">Various ways of writing Nesterov’s acceleration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2020-05-15-gradientboosting/">Gradient boosting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2020-05-26-bayesian-logistic-regression/">Bayesian logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2018-05-22-io-model/">The I/O Model</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">

<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Online convex optimization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-game-are-we-playing">What game are we playing?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#follow-the-leader-ftl">Follow the Leader (FTL)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#be-the-leader-blt">Be The Leader (BLT)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#follow-the-regularized-leader-ftrl">Follow The Regularized Leader (FTRL)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stability">Stability</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regret-bound-for-ftrl">Regret bound for FTRL</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ftrl-with-linear-losses">FTRL with linear losses</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-loss-is-sufficient">Linear loss is sufficient</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                   <div class="math notranslate nohighlight">
\[\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}\]</div>
<section class="tex2jax_ignore mathjax_ignore" id="online-convex-optimization">
<h1>Online convex optimization<a class="headerlink" href="#online-convex-optimization" title="Permalink to this headline">#</a></h1>
<p><em>Posted on 2019-11-02</em></p>
<div class="admonition-disclaimer admonition">
<p class="admonition-title">Disclaimer</p>
<p>We will require some familiarity with convex optimization.</p>
</div>
<section id="what-game-are-we-playing">
<h2>What game are we playing?<a class="headerlink" href="#what-game-are-we-playing" title="Permalink to this headline">#</a></h2>
<p>The player is given a fixed compact convex decision set <span class="math notranslate nohighlight">\(\mathcal X\)</span>.
At each round <span class="math notranslate nohighlight">\(t=1,...,T\)</span>:</p>
<ol class="arabic simple">
<li><p>Player pick <span class="math notranslate nohighlight">\(\mathbf x_t \in \mathcal X\)</span>.</p></li>
<li><p>The environment picks a convex loss function <span class="math notranslate nohighlight">\(f_t: \mathcal X \rightarrow [0,1]\)</span>.</p></li>
<li><p>The player then gets access to <span class="math notranslate nohighlight">\(f_t\)</span> and suffers loss <span class="math notranslate nohighlight">\(f_t(\mathbf x_t)\)</span>.</p></li>
</ol>
<p>We want to have some notion of whether we are doing well.
In the above setting simply using <span class="math notranslate nohighlight">\(\sum_{t=1}^T f_t(\mathbf x_t)\)</span> we could never do well since the environment can pick a new adversarial function <span class="math notranslate nohighlight">\(f_t\)</span> every time.
Instead we compare ourselves with the best fixed strategy <span class="math notranslate nohighlight">\(\mathbf x\)</span>:</p>
<div class="proof definition admonition" id="definition-0">
<p class="admonition-title"><span class="caption-number">Definition 1 </span> (Regret)</p>
<section class="definition-content" id="proof-content">
<p>The regret of the player is defined as</p>
<div class="math notranslate nohighlight">
\[\mathcal R_t = \sum_{t=1}^T f_t(\mathbf x_t) - \min_{\mathbf x} \sum_{t=1}^T f_t(\mathbf x).\]</div>
</section>
</div><p>This is called the <em>regret</em> as it captures how badly we did in hindsight.<label for='sidenote-role-1' class='margin-toggle'><span id="id1">
<sup>1</sup></span>

</label><input type='checkbox' id='sidenote-role-1' name='sidenote-role-1' class='margin-toggle'><span class="sidenote"><sup>1</sup>Ideally we want <span class="math notranslate nohighlight">\(\mathcal R_T = o(T)\)</span> since then <span class="math notranslate nohighlight">\(lim_{T\rightarrow \infty} \mathcal R_T/T = 0\)</span>.</span></p>
</section>
<section id="follow-the-leader-ftl">
<h2>Follow the Leader (FTL)<a class="headerlink" href="#follow-the-leader-ftl" title="Permalink to this headline">#</a></h2>
<p>To get a feel let us first try a naive approach.
A straight forward idea is what goes by the name of Follow The Leader (FTL) in the machine learning community and <em>ficticious</em> play in economics.
We picks</p>
<div class="math notranslate nohighlight">
\[\mathbf x_t = \argmin_{\mathbf x} = \sum_{\tau=1}^{t-1} f_\tau (\mathbf x) \quad \text{(best strategy so far)}\]</div>
<!-- Ex -->
<p>However, there is a simple adversarial strategy against this algorithm for the environment.
Consider <span class="math notranslate nohighlight">\(\mathcal X = \set{-1,1}\)</span> then the environment picks</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
f_1(\mathbf x) &amp;= \frac 12 \quad \text{and} \\
f_t(\mathbf x) &amp;\quad \text{alternates between $-\mathbf x$ and $\mathbf x$ for $t=2,...,T$}.
\end{split}
\end{split}\]</div>
<p>So when minimizing the following at every <span class="math notranslate nohighlight">\(t\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\sum_{\tau=1}^{t} f_\tau (\mathbf x) = \begin{cases}
\frac 12 \mathbf x &amp; t\ \text{is odd} \\
- \frac 12 \mathbf x &amp; \text{otherwise}
\end{cases}
\end{split}\]</div>
<p>We will end up always picking the <span class="math notranslate nohighlight">\(\mathbf x_{t+1}\)</span> that leads to the maximum regret <span class="math notranslate nohighlight">\(f_{t+1}(\mathbf x_{t+1})\)</span>.
So we achieve the lower bound of the regret.
Can we do better?</p>
</section>
<section id="be-the-leader-blt">
<h2>Be The Leader (BLT)<a class="headerlink" href="#be-the-leader-blt" title="Permalink to this headline">#</a></h2>
<p>Let’s say that we could cheat and play <span class="math notranslate nohighlight">\(\mathbf x_{t+1}\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> – thus avoiding the adversary.
For notational convenience we still keep the same definition:</p>
<div class="math notranslate nohighlight">
\[\mathbf x_t = \argmin_{\mathbf x} = \sum_{\tau=1}^{t-1} f_\tau (\mathbf x).\]</div>
<p>However, now in the regret analysis we incur <span class="math notranslate nohighlight">\(f_t(\mathbf x_{t+1})\)</span> instead of <span class="math notranslate nohighlight">\(f_t(\mathbf x_t)\)</span>.
We can now redo the regret analysis:</p>
<!-- Lm & Pf -->
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned} \mathcal R_{T}^{\mathrm{BTL}} 
  &amp;=\sum_{t=1}^{T} f_{t}\left(\mathbf x_{t+1}\right)-\min _{\mathbf x} \sum_{t=1}^T f_{t}(\mathbf x) \\ 
  &amp;=\sum_{t=1}^{T} f_{t}\left(\mathbf x_{t+1}\right)-\sum_{t=1}^{T} f_{t}\left(\mathbf x_{T+1}\right) &amp;&amp; \text{(by def of $\mathbf x_t$)}\\ 
  &amp;=\sum_{t=1}^{T-1} f_{t}\left(\mathbf x_{t+1}\right)-\sum_{t=1}^{T-1} f_{t}\left(\mathbf x_{T+1}\right) &amp;&amp; \text{(last terms are equal $(*)$)}\\ 
  &amp; \leqslant \sum_{t=1}^{T-1} f_{t}\left(\mathbf x_{t+1}\right)-\sum_{t=1}^{T-1} f_{t}\left(\mathbf x_{T}\right) &amp;&amp; \text{(since $\mathbf x_T$ is the actual minimum)}\\
  &amp; \leqslant f_{1}\left(\mathbf x_{2}\right)-f_{1}\left(\mathbf x_{3}\right) &amp;&amp; \text{(recurse until $T-i=1$ in $(*)$)} \\ 
  &amp; \leqslant 0 &amp;&amp; \text{(since $f_1(\mathbf x_2)$ is the minimum.)}
\end{aligned}
\end{split}\]</div>
<p>Not surprisingly BTL’s regret is negative.
But it provides an interesting insight:</p>
<div class="math notranslate nohighlight">
\[
\sum_{t=1}^T f_t(\mathbf x_t) - \min_{\mathbf{x}} \sum_{t=1}^T f_t(\mathbf x)
\leq \sum_{t=1}^T (f_t(\mathbf x_t) - f_t(\mathbf x_{t+1})).
\]</div>
<p>The above is just a simplification of <span class="math notranslate nohighlight">\(\mathcal R_T^{\mathrm{FTL}} - 0 \leq \mathcal R_T^{\mathrm{FTL}} - \mathcal R_T^{\mathrm{BTL}}\)</span> which is immediately obtained by application of the BTL bound.</p>
<p>So <span class="math notranslate nohighlight">\(\mathcal R_T^{\mathrm{FTL}}\)</span> is no worse than the difference between <span class="math notranslate nohighlight">\(f_t(\mathbf x_t)\)</span> and <span class="math notranslate nohighlight">\(f_t(\mathbf x_{t+1})\)</span>.
Intuitively a solution to our problem with FTL is then to make sure the strategy <span class="math notranslate nohighlight">\(\mathbf x_t\)</span> does not change too much – in other words: we want to regularize / stabilize!</p>
</section>
<section id="follow-the-regularized-leader-ftrl">
<h2>Follow The Regularized Leader (FTRL)<a class="headerlink" href="#follow-the-regularized-leader-ftrl" title="Permalink to this headline">#</a></h2>
<p>We modify our selection</p>
<div class="math notranslate nohighlight">
\[
\mathbf x_{t}=\operatorname{argmin}_{\mathbf x} \sum_{t=1}^{T} f_{t}(\mathbf x)+\frac{1}{\eta} \psi(\mathbf x)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\eta &gt; 0\)</span> is the learning rate and <span class="math notranslate nohighlight">\(\psi: \mathcal X \rightarrow \mathbb R\)</span> is a regularizer.</p>
<p>The regularizer is there to ensure that our choice does not change too much between iterations.
To capture this we will rely on <span class="math notranslate nohighlight">\(\psi\)</span> being strongly convex.
That is,</p>
<div class="math notranslate nohighlight">
\[\psi(\mathbf x)-\psi(\mathbf y) \leqslant \nabla \psi(\mathbf x)^{T}(\mathbf x-\mathbf y)-\frac{1}{2}\|\mathbf x-\mathbf y\|^{2} \quad \forall \mathbf y, \mathbf x \in \mathcal X\]</div>
<p>for some norm <span class="math notranslate nohighlight">\(||\cdot||\)</span>.</p>
<section id="stability">
<h3>Stability<a class="headerlink" href="#stability" title="Permalink to this headline">#</a></h3>
<p>This will allow us to prove the following notion of <em>stability</em>.</p>
<div class="proof lemma admonition" id="lemma-1">
<p class="admonition-title"><span class="caption-number">Lemma 1 </span> (Stability)</p>
<section class="lemma-content" id="proof-content">
<p>Stability says that</p>
<div class="math notranslate nohighlight">
\[f_{t}\left(\mathbf x_{t}\right)-f_{t}\left(\mathbf x_{t+1}\right) \leqslant \eta\left\|\nabla f_{t}\left(\mathbf x_{t}\right)\right\|_{*}^{2}\]</div>
<p>with <span class="math notranslate nohighlight">\(\|\cdot\|_*\)</span> is the dual norm of <span class="math notranslate nohighlight">\(\|\cdot\|\)</span> defined as <span class="math notranslate nohighlight">\(\|\mathbf x\|_{*}=\sup _{\|\mathbf y\| \leqslant 1} \mathbf x^{\top} \mathbf y\)</span>.</p>
</section>
</div><span class="sidenote proof" id="proof"><sup>2</sup>This will ultimately let us bound <span class="math notranslate nohighlight">\(f_t(\textbf x_t) - f_t(\textbf x_{t+1})\)</span>.</span><span class="sidenote proof" id="proof"><sup>3</sup><strong>First order characterization</strong> of convexity says <span class="math notranslate nohighlight">\(f(\mathbf y) - f(\mathbf x) \leq \nabla f(\mathbf y)^\top (\mathbf y - \mathbf x)\)</span>. So when <span class="math notranslate nohighlight">\(f(\mathbf y)\)</span> is minimum we have <span class="math notranslate nohighlight">\(\nabla f(\mathbf y)^\top (\mathbf y - \mathbf x) \geq 0\)</span>.</span><div class="proof admonition" id="proof">
<p>Proof. Let’s define the function we minimizes in the decision selection</p>
<div class="math notranslate nohighlight">
\[
F_{t}(\mathbf x)=\sum_{\tau=1}^{t} f_{\tau}(\mathbf x)+\frac{1}{\eta} \psi(\mathbf x)
\]</div>
<p>By strong convexity of <span class="math notranslate nohighlight">\(\psi\)</span> and convexity of <span class="math notranslate nohighlight">\(f_\tau\)</span> we have that <label for='sidenote-role-2' class='margin-toggle'><span id="id2">
<sup>2</sup></span>

</label><input type='checkbox' id='sidenote-role-2' name='sidenote-role-2' class='margin-toggle'><span class="sidenote d-n"><sup>2</sup>This will ultimately let us bound <span class="math notranslate nohighlight">\(f_t(\textbf x_t) - f_t(\textbf x_{t+1})\)</span>.</span></p>
<div class="math notranslate nohighlight" id="equation-eq-sum-bound">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-sum-bound" title="Permalink to this equation">#</a></span>\[F_{t-1}\left(\mathbf x_{t}\right)-F_{t-1}\left(\mathbf x_{t+1}\right) \leqslant\left\langle\nabla F_{t-1}\left(\mathbf x_{t}\right), \mathbf x_{t}-\mathbf x_{t+1}\right\rangle-\frac{1}{2 \eta}\left\|\mathbf x_{t}-\mathbf x_{t+1}\right\|^{2} \quad \text{for any } \mathbf{x}_t, \mathbf{x}_{t+1} \in \mathcal X.\]</div>
<p>FTRL defines <span class="math notranslate nohighlight">\(\mathbf x_{t}=\argmin_{\mathbf{x}} F_{t-1}(\mathbf x)\)</span> so <span class="math notranslate nohighlight">\(F_{t-1}(\mathbf x_t)\)</span> is the optimum and first order characterization<label for='sidenote-role-3' class='margin-toggle'><span id="id3">
<sup>3</sup></span>

</label><input type='checkbox' id='sidenote-role-3' name='sidenote-role-3' class='margin-toggle'><span class="sidenote d-n"><sup>3</sup><strong>First order characterization</strong> of convexity says <span class="math notranslate nohighlight">\(f(\mathbf y) - f(\mathbf x) \leq \nabla f(\mathbf y)^\top (\mathbf y - \mathbf x)\)</span>. So when <span class="math notranslate nohighlight">\(f(\mathbf y)\)</span> is minimum we have <span class="math notranslate nohighlight">\(\nabla f(\mathbf y)^\top (\mathbf y - \mathbf x) \geq 0\)</span>.</span> becomes</p>
<div class="math notranslate nohighlight">
\[
\left\langle\nabla F_{t-1}\left(\mathbf x_{t}\right), \mathbf x_{t}-\mathbf x_{t+1}\right\rangle \leqslant 0.
\]</div>
<p>So a weaker bound of <a class="reference internal" href="#equation-eq-sum-bound">(1)</a> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
F_{t-1}(\mathbf x_{t})-F_{t-1}(\mathbf x_{t+1}) &amp; \leqslant-\frac{1}{2 \eta}\|\mathbf x_{t}-\mathbf x_{t+1}\|^{2} \quad \text { and } \\ 
F_{t}(\mathbf x_{t+1})-F_{t}(\mathbf x_{t}) &amp; \leqslant-\frac{1}{2 \eta}\|\mathbf x_{t}-\mathbf x_{t+1}\|^{2}.\end{aligned}
\end{split}\]</div>
<p>The second line simply applies the same reasoning.
We can now sum the two lines and expand the definition of <span class="math notranslate nohighlight">\(F_i\)</span>.
All terms will cancel out except the last term in <span class="math notranslate nohighlight">\(F_t(\mathbf x_{t+1})\)</span> and <span class="math notranslate nohighlight">\(F_t(\mathbf x_{t})\)</span> so we get</p>
<div class="math notranslate nohighlight" id="equation-eq-sq-bound">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-sq-bound" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
f_{t}(\mathbf x_{t+1})-f_{t}(\mathbf x_{t}) \leqslant-\frac{1}{y}\|\mathbf x_{t}-\mathbf x_{t+1}\|^{2} &amp;\Leftrightarrow \\
\|\mathbf x_{t}-\mathbf x_{t+1}\|^{2} \leqslant \eta(f_{t}(\mathbf x_{t})-f_{t}(\mathbf x_{t+1}))&amp;.\end{aligned}
\end{split}\]</div>
<p>Now we have the tools to bound the change.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned} f_{t}\left(\mathbf x_{t}\right)-f_{t}\left(\mathbf x_{t+1}\right) &amp; \leqslant\left\langle\nabla f_{t}\left(\mathbf x_{t}\right), \mathbf x_{t}-\mathbf x_{t+1}\right\rangle &amp;&amp; \text {(Convexity)} \\ &amp; \leqslant\left\|\nabla f_{t}\left(\mathbf x_{t}\right)\right\|\left\|\mathbf x_{t}-\mathbf x_{t+1}\right\| &amp;&amp; \text {(Hölder's ineq.)} \\ &amp; \leqslant\left\|\nabla f_{t}\left(\mathbf x_{t}\right)\right\|_{*} \sqrt{\eta} \sqrt{F_{t}\left(\mathbf x_{t}\right)-f_{t}\left(\mathbf x_{t+1}\right)} &amp;&amp; \text{(using prev. eq.)} \end{aligned}\end{split}\]</div>
<aside class="margin sidebar">
<p class="sidebar-title">Hölder’s inequality</p>
<p><span class="math notranslate nohighlight">\(\langle x, y\rangle \leqslant\|x\|\|y\|_{*}\)</span>.</p>
</aside>
<p>Solving for <span class="math notranslate nohighlight">\(f_t(\mathbf x_t) -f_t(\mathbf x_{t+1})\)</span> we get</p>
<div class="math notranslate nohighlight">
\[f\left(\mathbf x_{t}\right)-f_{t}\left(\mathbf x_{t+1}\right) \leqslant \eta\left\|\nabla_{t} f\left(\mathbf x_{t}\right)\right\|_{*}^{2}\]</div>
</div>
<p>Equipped with stability and the BTL lemma we almost directly obtain the regret bound for FTRL.</p>
</section>
<section id="regret-bound-for-ftrl">
<h3>Regret bound for FTRL<a class="headerlink" href="#regret-bound-for-ftrl" title="Permalink to this headline">#</a></h3>
<div class="proof theorem admonition" id="theorem-2">
<p class="admonition-title"><span class="caption-number">Theorem 1 </span></p>
<section class="theorem-content" id="proof-content">
<p>With learning rate <span class="math notranslate nohighlight">\(\eta\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\mathcal R_{T}^{\mathrm{FTRL}} \leqslant \frac{D}{\eta}+\eta \sum_{t=1}^{T}\left\|\nabla f_{t}\left(\mathbf x_{t}\right)\right\|_{*}^{2}\]</div>
<p>where <span class="math notranslate nohighlight">\(D=\max_{\mathbf x} \psi(\mathbf x)-m_{\mathbf x} n \varphi(\mathbf x)\)</span>.</p>
</section>
</div><span class="sidenote proof" id="proof"><sup>4</sup>Note that we additionally use <span class="math notranslate nohighlight">\(f_0(\mathbf x^*) \geq f_0(\mathbf x_1)\)</span> since BTL only applies to <span class="math notranslate nohighlight">\(t=1,...,T\)</span>.</span><span class="sidenote proof" id="proof"><sup>5</sup>We want to use stability so we need to move from <span class="math notranslate nohighlight">\(\mathbf x^*\)</span> to <span class="math notranslate nohighlight">\(\mathbf x_{t+1}\)</span>. We do this by getting it on a form on which we can apply the BTL lemma.</span><div class="proof admonition" id="proof">
<p>Proof. By defining <span class="math notranslate nohighlight">\(f_0(\mathbf x) = \frac 1\eta \psi(\mathbf x)\)</span> we can write the regularized selection as</p>
<div class="math notranslate nohighlight">
\[\mathbf x_{t}=\argmin_{\mathbf x} \sum_{r=1}^{t-1} f_{\tau}(\mathbf x)+\frac{1}{\eta} \psi(\mathbf x)=\argmin_{\mathbf x} \sum_{\tau=0}^{t-1} f_{\tau}(\mathbf x)\]</div>
<p>First note that by the BTL lemma we have<label for='sidenote-role-4' class='margin-toggle'><span id="id4">
<sup>4</sup></span>

</label><input type='checkbox' id='sidenote-role-4' name='sidenote-role-4' class='margin-toggle'><span class="sidenote d-n"><sup>4</sup>Note that we additionally use <span class="math notranslate nohighlight">\(f_0(\mathbf x^*) \geq f_0(\mathbf x_1)\)</span> since BTL only applies to <span class="math notranslate nohighlight">\(t=1,...,T\)</span>.</span></p>
<div class="math notranslate nohighlight">
\[\sum_{t=0}^{T} f_{t}\left(\mathbf x^{*}\right) \geqslant \sum_{t=0}^{T} f_{t}\left(\mathbf x_{t+1}\right)\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[
w^{*}=\argmin_{\mathbf x} \sum_{t=1}^{T} f_{t}(\mathbf x) \quad \text{(best fixed expert)}
\]</div>
<p>Now we can bound the FTRL regret as follows<label for='sidenote-role-5' class='margin-toggle'><span id="id5">
<sup>5</sup></span>

</label><input type='checkbox' id='sidenote-role-5' name='sidenote-role-5' class='margin-toggle'><span class="sidenote d-n"><sup>5</sup>We want to use stability so we need to move from <span class="math notranslate nohighlight">\(\mathbf x^*\)</span> to <span class="math notranslate nohighlight">\(\mathbf x_{t+1}\)</span>. We do this by getting it on a form on which we can apply the BTL lemma.</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned} \mathcal R_T^{\mathrm{FTRL}} &amp;=\sum_{t=1}^{T} f_{t}\left(\mathbf x_{t}\right)-\sum_{t=1}^{T} f_{t}\left(\mathbf x^{*}\right) \\ &amp;=\sum_{t=1}^{T} f_{t}\left(\mathbf x_{t}\right)-\sum_{t=1}^{t} f_{t}\left(\mathbf x^{*}\right)+f_{0}\left(\mathbf x^{*}\right) \\ &amp; \leqslant \sum_{t=1}^{T} f_{t}\left(\mathbf x_{t}\right)-\sum_{t=0}^{T} f_{t}\left(\mathbf x_{t+1})+f_{0}\left(\mathbf x^{*}\right) \right. &amp;&amp; \text{(using BTL lemma)}\\ &amp; \leqslant \eta \sum_{t=1}^{T} \| \nabla_{t} f\left(\mathbf x_{t}\right) \|_{*}^{2}+f_{0}\left(\mathbf x^{*}\right)-f_{0}\left(\mathbf x_{1}\right) &amp;&amp; (\text {using stability}) \\ &amp; \leqslant \eta \sum_{t=1}^{T}\left\|\nabla_{t} f\left(\mathbf x_{t}\right)\right\|_{*}^{2}+\frac{1}{\eta}(\underbrace{\max _{\mathbf x} \psi(\mathbf x) - \min_{\mathbf x} \psi(\mathbf x)}_{D})\end{aligned}\end{split}\]</div>
</div>
<div class="proof corollary admonition" id="corollary-3">
<p class="admonition-title"><span class="caption-number">Corollary 1 </span></p>
<section class="corollary-content" id="proof-content">
<p>Further, if <span class="math notranslate nohighlight">\(f_t(\mathbf x)\)</span> is <span class="math notranslate nohighlight">\(G\)</span>-Lipschitz constraint (so that the gradient is bounded <span class="math notranslate nohighlight">\(\| \nabla_t f_t(\mathbf x_t)\|_* \leq G\)</span>) and the optimal learning rate <span class="math notranslate nohighlight">\(\eta = \sqrt{\frac {D}{TG^2}}\)</span> is chosen, then we have</p>
<div class="math notranslate nohighlight">
\[\mathcal R_T^{\mathrm{FTRL}} = \mathcal O (G\sqrt{TD}).\]</div>
</section>
</div><div class="proof remark admonition" id="remark-4">
<p class="admonition-title"><span class="caption-number">Remark 1 </span></p>
<section class="remark-content" id="proof-content">
<p>The optimal <span class="math notranslate nohighlight">\(\eta\)</span> is found by simply optimizing the above regret bound which is of the form:</p>
<div class="math notranslate nohighlight">
\[\argmax _{n} a x+b x^{-1}=\frac{\sqrt{b}}{\sqrt{a}}.\]</div>
</section>
</div></section>
</section>
<section id="ftrl-with-linear-losses">
<h2>FTRL with linear losses<a class="headerlink" href="#ftrl-with-linear-losses" title="Permalink to this headline">#</a></h2>
<p>At this point we have good regret bounds but at every iteration <span class="math notranslate nohighlight">\(t\)</span> we have to minimize a sum of <span class="math notranslate nohighlight">\(t\)</span> convex functions.
This simplifies significantly if we assume that the loss is linear <span class="math notranslate nohighlight">\(f_{t}(\mathbf x)=\left\langle \mathbf g_{t}, \mathbf x\right\rangle\)</span> since we can push in the summation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned} \mathbf x_{t} &amp;=\argmin_{\mathbf x} \sum_{\tau=1}^{t-1}\left\langle \mathbf g_{\tau}, \mathbf x\right\rangle+\frac{1}{\eta} \psi(\mathbf x) \\ &amp;=\argmin_{\mathbf x} \left\langle\sum_{\tau=1}^{t-1} \mathbf g_\tau, \mathbf x\right\rangle+\frac{1}{\eta} \psi(\mathbf x). \end{aligned}
\end{split}\]</div>
<p>Now we only have to keep track of a sum of gradients <span class="math notranslate nohighlight">\(\mathbf u_t = \sum_{\tau=1}^T \mathbf g_\tau\)</span> and the minimization problem reduces to a sum of a linear function and the strongly convex regularizer.
So we can write the program as:</p>
<div class="proof algorithm admonition" id="algorithm-5">
<p class="admonition-title"><span class="caption-number">Algorithm 1 </span> (FTRL with linear loss)</p>
<section class="algorithm-content" id="proof-content">
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf x_{t+1}=\argmin_{\mathbf x}\left\langle \mathbf u_{t}, \mathbf x\right\rangle+\frac{1}{\eta} \psi(\mathbf x)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf u_{t+1}=\mathbf u_{t}+\mathbf g_{t}\)</span></p></li>
</ol>
</section>
</div><section id="linear-loss-is-sufficient">
<h3>Linear loss is sufficient<a class="headerlink" href="#linear-loss-is-sufficient" title="Permalink to this headline">#</a></h3>
<p>It turns out that we can assume linear loss without loss of generality!
That is, we can get the same regret bound for convex loss functions even if we run the above algorithm only using the gradient <span class="math notranslate nohighlight">\(\mathbf g_t = \nabla f_t(\mathbf x_t)\)</span> at each <span class="math notranslate nohighlight">\(\mathbf x_t\)</span>.
To see this, consider</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned} \mathcal R_{T}^{\mathrm{FTRL}} &amp; \leqslant \max _{\mathbf x} \sum_{t=1}^{T} f_{t}\left(u_{t}\right)-f_{t}(\mathbf x) \\ &amp; \leqslant \max _{\mathbf x} \sum_{t=1}^{T}\left\langle\nabla f_{t}\left(\mathbf x_{t}\right), \mathbf x_{t}-\mathbf x\right\rangle. &amp;&amp; \text{(Convexity applied to each term)}\end{aligned}\end{split}\]</div>
<p>So we can bound the regret for <span class="math notranslate nohighlight">\(f_t(\mathbf x)\)</span> by bounding the regret for the new problem which only considers its gradient <span class="math notranslate nohighlight">\(f'_t(\mathbf x)=\braket{\nabla f_t(\mathbf x_t), \mathbf x}\)</span>.
The bound stays as tight since we already used convexity in our argument for <em>stability</em>.</p>
<p><em>These notes are primarily based on Prof. Luo’s lectures notes <span id="id6">[<a class="reference internal" href="#id18" title="CSCI 699: Introduction to Online Learning. 2019. URL: https://haipeng-luo.net/courses/CSCI699/ (visited on 2019-11-02)."><em>CSCI 699: Introduction to Online Learning</em>, 2019</a>]</span> with minor modifications borrowed from Hazan’s book <span id="id7">[<a class="reference internal" href="#id20" title="Elad Hazan. Introduction to Online Convex Optimization. 2019. URL: http://arxiv.org/abs/1909.05207 (visited on 2019-11-02), arXiv:1909.05207.">Hazan, 2019</a>]</span> and the lecture notes of Prof. Orabona <span id="id8">[<a class="reference internal" href="#id19" title="Introduction to Online Learning. 2019. URL: https://parameterfree.com/lecture-notes-on-online-learning/ (visited on 2019-11-02)."><em>Introduction to Online Learning</em>, 2019</a>]</span></em>.</p>
<hr class="docutils" />
<div class="docutils container" id="id9">
<dl class="citation">
<dt class="label" id="id19"><span class="brackets"><a class="fn-backref" href="#id8">Int19</a></span></dt>
<dd><p>Introduction to Online Learning. 2019. URL: <a class="reference external" href="https://parameterfree.com/lecture-notes-on-online-learning/">https://parameterfree.com/lecture-notes-on-online-learning/</a> (visited on 2019-11-02).</p>
</dd>
<dt class="label" id="id18"><span class="brackets"><a class="fn-backref" href="#id6">CSC19</a></span></dt>
<dd><p>CSCI 699: Introduction to Online Learning. 2019. URL: <a class="reference external" href="https://haipeng-luo.net/courses/CSCI699/">https://haipeng-luo.net/courses/CSCI699/</a> (visited on 2019-11-02).</p>
</dd>
<dt class="label" id="id20"><span class="brackets"><a class="fn-backref" href="#id7">Haz19</a></span></dt>
<dd><p>Elad Hazan. Introduction to Online Convex Optimization. 2019. URL: <a class="reference external" href="http://arxiv.org/abs/1909.05207">http://arxiv.org/abs/1909.05207</a> (visited on 2019-11-02), <a class="reference external" href="https://arxiv.org/abs/1909.05207">arXiv:1909.05207</a>.</p>
</dd>
</dl>
</div>
<hr class="footnotes docutils" />
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./posts"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>
<div class="section">
    
  
</div>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../../online-learning/"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Online learning</p>
      </div>
    </a>
    <a class="right-next"
       href="../2020-01-06-hedge-and-bandit/"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hedge and bandits</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-game-are-we-playing">What game are we playing?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#follow-the-leader-ftl">Follow the Leader (FTL)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#be-the-leader-blt">Be The Leader (BLT)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#follow-the-regularized-leader-ftrl">Follow The Regularized Leader (FTRL)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stability">Stability</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regret-bound-for-ftrl">Regret bound for FTRL</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ftrl-with-linear-losses">FTRL with linear losses</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-loss-is-sufficient">Linear loss is sufficient</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Thomas Pethick
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>